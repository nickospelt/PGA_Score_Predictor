-- Use these results to determine how hard the tournament itself will attempt to play
-- Think there tend to be more general trends here a simple weighted average towards the most recent year could give a good idea
WITH STAT_AVGS AS (
SELECT TOURNAMENT_NAME, AVG(GIR_PERCENTAGE) AVG_GIR, AVG(SCRAMBLING_PERCENTAGE) AVG_SCRAMB,
    AVG(R1_PUTTS) AVG_R1_PUTT, AVG(R2_PUTTS) AVG_R2_PUTTS
FROM PLAYER_TOURNAMENT_RESULTS_V2
GROUP BY 1
)

SELECT DISTINCT PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME,
    R1_AVG_SCORE, R2_AVG_SCORE, R3_AVG_SCORE, R4_AVG_SCORE,
    AVG_GIR, AVG_SCRAMB, AVG_R1_PUTT, AVG_R2_PUTTS, 
    (CASE 
     WHEN UPPER(PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME) LIKE "%MASTERS%" THEN 1.0
     WHEN UPPER(PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME) LIKE "%U.S. OPEN%" THEN 2.0
     WHEN UPPER(PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME) LIKE "%THE OPEN%" THEN 3.0
     WHEN UPPER(PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME) LIKE "%PGA%" THEN 4.0
     WHEN UPPER(PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME) LIKE "%PLAYERS%" THEN 5.0
  END) AS TOURNAMENT_F
FROM PLAYER_TOURNAMENT_RESULTS_V2 INNER JOIN STAT_AVGS ON PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME = STAT_AVGS.TOURNAMENT_NAME
ORDER BY TOURNAMENT_F, PLAYER_TOURNAMENT_RESULTS_V2.TOURNAMENT_NAME