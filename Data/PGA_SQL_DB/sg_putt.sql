WITH TOURNAMENT_AVERAGES AS (
    SELECT TOURNAMENT_NAME,
        AVG(SG_PUTT) AS TOURN_AVG_SG_PUTT
    FROM PLAYER_TOURNAMENT_RESULTS_V3
    GROUP BY 1
)
     

SELECT PLAYER_TOURNAMENT_RESULTS_V3.TOURNAMENT_NAME, TOURNAMENT_DATE, PLAYER_NAME, SG_PUTT, TOURN_AVG_SG_PUTT, SG_PUTT - TOURN_AVG_SG_PUTT AS ADJ_SG_PUTT,
    R1_SCORE - PAR AS R1_SCORE_TO_PAR,
    R2_SCORE - PAR AS R2_SCORE_TO_PAR,
    R3_SCORE - PAR AS R3_SCORE_TO_PAR,
    R4_SCORE - PAR AS R4_SCORE_TO_PAR
FROM PLAYER_TOURNAMENT_RESULTS_V3
INNER JOIN TOURNAMENT_AVERAGES ON PLAYER_TOURNAMENT_RESULTS_V3.TOURNAMENT_NAME = TOURNAMENT_AVERAGES.TOURNAMENT_NAME
ORDER BY PLAYER_NAME, PLAYER_TOURNAMENT_RESULTS_V3.TOURNAMENT_DATE