WITH
RAW_ROUND_AVGS AS (
    SELECT TOURNAMENT_NAME, AVG(R1_SCORE) - PAR, AVG(R2_SCORE) - PAR, AVG(R3_SCORE) - PAR, AVG(R4_SCORE) - PAR
    FROM PLAYER_TOURNAMENT_RESULTS
    GROUP BY 1
    )

SELECT *,
(CASE 
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%MASTERS%" THEN 1.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%U.S. OPEN%" THEN 2.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%THE OPEN%" THEN 3.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%PGA%" THEN 4.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%PLAYERS%" THEN 5.0
  END) AS TOURNAMENT_F
FROM RAW_ROUND_AVGS
ORDER BY TOURNAMENT_F
