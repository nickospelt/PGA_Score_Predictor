WITH
    ROUND_1 AS (
        SELECT TOURNAMENT_NAME, PLAYER_NAME, TEMPERATURE AS R1_TEMP, PRECIPITATION AS R1_PRECIP, WIND_SPEED AS R1_WIND_SPEED, WIND_DIRECTION AS R1_WIND_DIRECT, SCORE AS R1_SCORE
        FROM RAW_TOURNAMENT_ROUNDS_V2
        WHERE ROUND_NUMBER = 1
    ),
    ROUND_2 AS (
        SELECT TOURNAMENT_NAME, PLAYER_NAME, TEMPERATURE AS R2_TEMP, PRECIPITATION AS R2_PRECIP, WIND_SPEED AS R2_WIND_SPEED, WIND_DIRECTION AS R2_WIND_DIRECT, SCORE AS R2_SCORE
        FROM RAW_TOURNAMENT_ROUNDS_V2
        WHERE ROUND_NUMBER = 2
    ),
    ROUND_3 AS (
        SELECT TOURNAMENT_NAME, PLAYER_NAME, TEMPERATURE AS R3_TEMP, PRECIPITATION AS R3_PRECIP, WIND_SPEED AS R3_WIND_SPEED, WIND_DIRECTION AS R3_WIND_DIRECT, SCORE AS R3_SCORE
        FROM RAW_TOURNAMENT_ROUNDS_V2
        WHERE ROUND_NUMBER = 3
    ),
    ROUND_4 AS (
        SELECT TOURNAMENT_NAME, PLAYER_NAME, TEMPERATURE AS R4_TEMP, PRECIPITATION AS R4_PRECIP, WIND_SPEED AS R4_WIND_SPEED, WIND_DIRECTION AS R4_WIND_DIRECT, SCORE AS R4_SCORE
        FROM RAW_TOURNAMENT_ROUNDS_V2
        WHERE ROUND_NUMBER = 4
    )
    
SELECT DISTINCT RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME, 
    R1_TEMP, R1_PRECIP, R1_WIND_SPEED, R1_WIND_DIRECT,
    R2_TEMP, R2_PRECIP, R2_WIND_SPEED, R2_WIND_DIRECT,
    R3_TEMP, R3_PRECIP, R3_WIND_SPEED, R3_WIND_DIRECT,
    R4_TEMP, R4_PRECIP, R4_WIND_SPEED, R4_WIND_DIRECT,
    ELEVATION, COURSE_NAME, COURSE_LOCATION, PAR, LENGTH, R1_AVG_SCORE, R2_AVG_SCORE, R3_AVG_SCORE, R4_AVG_SCORE,
    PLAYER_ID, RAW_TOURNAMENT_ROUNDS_V2.PLAYER_NAME,
    GIR_PERCENTAGE, TOTAL_DRIVING_DISTANCE, FIR_PERCENTAGE, SCRAMBLING_PERCENTAGE, PUTTS_PER_ROUND, R1_PUTTS, R2_PUTTS,
    R1_SCORE, R2_SCORE, R3_SCORE, R4_SCORE
FROM RAW_TOURNAMENT_ROUNDS_V2
    INNER JOIN ROUND_1 ON RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME = ROUND_1.TOURNAMENT_NAME AND RAW_TOURNAMENT_ROUNDS_V2.PLAYER_NAME = ROUND_1.PLAYER_NAME
    INNER JOIN ROUND_2 ON RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME = ROUND_2.TOURNAMENT_NAME AND RAW_TOURNAMENT_ROUNDS_V2.PLAYER_NAME = ROUND_2.PLAYER_NAME
    INNER JOIN ROUND_3 ON RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME = ROUND_3.TOURNAMENT_NAME AND RAW_TOURNAMENT_ROUNDS_V2.PLAYER_NAME = ROUND_3.PLAYER_NAME
    INNER JOIN ROUND_4 ON RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME = ROUND_4.TOURNAMENT_NAME AND RAW_TOURNAMENT_ROUNDS_V2.PLAYER_NAME = ROUND_4.PLAYER_NAME
ORDER BY RAW_TOURNAMENT_ROUNDS_V2.TOURNAMENT_NAME, (R1_SCORE + R2_SCORE + R3_SCORE + R4_SCORE)