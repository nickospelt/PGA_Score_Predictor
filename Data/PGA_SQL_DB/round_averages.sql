WITH
ROUND_AVERAGES AS (
SELECT TOURNAMENT_NAME, ROUND_NUMBER, AVG(SCORE) AS AVG_SCORE
FROM RAW_TOURNAMENT_ROUNDS
GROUP BY 1,2
)

SELECT *,
(CASE 
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%MASTERS%" THEN 1.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%U.S. OPEN%" THEN 2.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%THE OPEN%" THEN 3.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%PGA%" THEN 4.0
     WHEN UPPER(TOURNAMENT_NAME) LIKE "%PLAYERS%" THEN 5.0
  END) AS TOURNAMENT_F
FROM ROUND_AVERAGES
ORDER BY TOURNAMENT_F, ROUND_NUMBER, TOURNAMENT_NAME